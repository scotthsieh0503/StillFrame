(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[800],{5110:(e,t,s)=>{Promise.resolve().then(s.bind(s,8923))},8923:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>h});var a=s(5155),r=s(2115),c=s(6658),n=s(8173),i=s.n(n),o=s(2651);let l="http://stillframe.local:5000",d="".concat("http://stillframe.local:3000","/music/callback");function h(){let e=(0,c.useRouter)(),[t,s]=(0,r.useState)(""),[n,h]=(0,r.useState)(""),[p,u]=(0,r.useState)(!1);return(0,r.useEffect)(()=>{(async function(){try{let e=(await o.A.get("".concat(l,"/api/setting/SPOTIFY"))).data.result;e.CLIENT_ID&&e.CLIENT_SECRET&&(s(e.CLIENT_ID),h(e.CLIENT_SECRET))}catch(e){console.error("Error fetching Spotify settings:",e)}})()},[]),(0,r.useEffect)(()=>{(async()=>{let e=new URLSearchParams(window.location.search).get("code");if(e&&t&&n){let{access_token:s,refresh_token:a}=(await o.A.post("https://accounts.spotify.com/api/token",new URLSearchParams({grant_type:"authorization_code",code:e,redirect_uri:d}),{headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic "+btoa("".concat(t,":").concat(n))}})).data;try{await o.A.post("".concat(l,"/api/setting/SPOTIFY"),{ACCESS_TOKEN:s,REFRESH_TOKEN:a,CLIENT_ID:t,CLIENT_SECRET:n})}catch(e){console.error("Error saving Spotify tokens:",e)}u(!0)}})()},[e,t,n]),(0,a.jsx)("div",{className:"grid grid-rows-[20px_1fr_20px] items-center justify-items-center min-h-screen p-8 pb-20 gap-16 sm:p-20 font-[family-name:var(--font-geist-sans)]",children:(0,a.jsxs)("main",{className:"flex flex-col gap-8 row-start-2 items-center items-start",children:[(0,a.jsx)("div",{className:"mt-8",children:(0,a.jsxs)("nav",{className:"breadcrumb",children:[(0,a.jsx)(i(),{href:"/",children:"Home"})," / ",(0,a.jsx)("span",{children:"Music"})]})}),p&&(0,a.jsxs)("div",{className:"flex items-center gap-2 text-green-600",children:[(0,a.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",className:"h-6 w-6",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",strokeWidth:2,children:(0,a.jsx)("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M5 13l4 4L19 7"})}),(0,a.jsx)("span",{children:"Authenticated successfully"})]})]})})}}},e=>{var t=t=>e(e.s=t);e.O(0,[651,441,587,358],()=>t(5110)),_N_E=e.O()}]);